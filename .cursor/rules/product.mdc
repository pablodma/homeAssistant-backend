---
description: Contexto de producto y PRD de HomeAI Assistant
globs:
  - "**/*"
alwaysApply: true
---

# HomeAI Assistant - Product Context

## VisiÃ³n del Producto

**HomeAI Assistant** es un asistente virtual para gestiÃ³n del hogar que opera via WhatsApp, permitiendo a familias organizar sus finanzas, agenda, recordatorios y compras de forma conversacional.

### Propuesta de Valor
- **Para familias ocupadas** que necesitan organizar su hogar
- **Via WhatsApp** (canal que ya usan diariamente)
- **Conversacional e inteligente** (no menÃºs ni comandos rÃ­gidos)
- **Multi-tenant SaaS** (un nÃºmero de WhatsApp sirve mÃºltiples hogares)

## Estado Actual

### Fase 2: MVP (ACTUAL)
- âœ… Bot migrado a cÃ³digo Python (sin N8N)
- âœ… 5 agentes funcionando (Finance, Calendar, Reminder, Shopping, Vehicle)
- âœ… Panel de administraciÃ³n para editar prompts
- âœ… Logging de interacciones
- âœ… IntegraciÃ³n Google Calendar
- ğŸ”„ Multi-tenant (implementado pero usando tenant fijo)
- ğŸ”„ Testing y estabilizaciÃ³n

### PrÃ³xima Fase: ProducciÃ³n
- [ ] Multi-tenant completo (onboarding self-service)
- [ ] Recordatorios proactivos (templates WhatsApp aprobados)
- [ ] Manejo de errores robusto
- [ ] Rate limiting
- [ ] MÃ©tricas y alertas

## Usuarios Objetivo

### Usuario Primario: "El Organizador del Hogar"
- Adulto (25-55 aÃ±os) responsable de la gestiÃ³n domÃ©stica
- Usa WhatsApp diariamente
- Quiere reducir carga mental de recordar todo
- Valora simplicidad sobre features complejos

### Usuario Secundario: "Miembros del Hogar"
- Familia/convivientes del organizador
- Acceso limitado (agregar gastos, ver listas)
- No necesitan instalar nada nuevo

## Funcionalidades Implementadas

### 1. GestiÃ³n de Presupuesto y Gastos âœ…
**Problema:** "No sÃ© en quÃ© se me va la plata"

**Flujo:**
```
Usuario: "GastÃ© 3500 en el super"
Bot: "âœ“ Registrado: $3,500 en Supermercado. 
      Llevas $12,500/$20,000 este mes (62%)"
```

**Capacidades:**
- Registrar gastos via chat
- Reportes por perÃ­odo y categorÃ­a
- Alertas de presupuesto

### 2. Agenda de Eventos âœ…
**Problema:** "Se me olvidan las citas y eventos"

**Flujo:**
```
Usuario: "Agendame reuniÃ³n de padres el viernes 15 a las 18"
Bot: "âœ“ Creado: ReuniÃ³n de padres
      ğŸ“… Viernes 15/3 a las 18:00"
```

**Capacidades:**
- Crear, ver, editar eventos
- SincronizaciÃ³n con Google Calendar (OAuth individual)
- DetecciÃ³n de conflictos

### 3. Recordatorios âœ…
**Problema:** "Siempre me olvido de hacer X"

**Flujo:**
```
Usuario: "Recordame maÃ±ana llamar al banco"
Bot: "âœ“ Recordatorio creado: Llamar al banco
      ğŸ“… MaÃ±ana a las 09:00"
```

**Capacidades:**
- Recordatorios Ãºnicos y recurrentes
- Almacenamiento directo en DB
- âš ï¸ Notificaciones proactivas pendientes (requiere templates aprobados)

### 4. Listas de Compras âœ…
**Problema:** "Siempre me olvido algo en el super"

**Flujo:**
```
Usuario: "AgregÃ¡ leche a la lista del super"
Bot: "âœ“ Agregado: Leche a Lista Supermercado"
```

**Capacidades:**
- MÃºltiples listas
- Agregar/quitar items
- Marcar como comprado

### 5. GestiÃ³n de VehÃ­culos âœ…
**Problema:** "Â¿CuÃ¡ndo le toca el service al auto?"

**Flujo:**
```
Usuario: "Registrame que le cambiÃ© el aceite al auto"
Bot: "âœ“ Service registrado: Cambio de aceite
      ğŸš— Toyota Corolla (ABC123)
      ğŸ“… 08/02/2026 - 45,000 km"
```

**Capacidades:**
- Registro de vehÃ­culos
- Historial de servicios
- Recordatorios de mantenimiento

## Panel de AdministraciÃ³n âœ…

Interfaz web para gestionar el bot:

| Funcionalidad | Estado |
|---------------|--------|
| Ver estadÃ­sticas | âœ… |
| Editar prompts de agentes | âœ… |
| Ver historial de versiones | âœ… |
| Ver interacciones | âœ… |
| Filtrar por agente/usuario/fecha | âœ… |
| Ver detalle de interacciÃ³n | âœ… |

## Principios de DiseÃ±o Conversacional

### DO's âœ“
- **MÃ­nimas preguntas**: Inferir lo que se pueda del contexto
- **ConfirmaciÃ³n solo para acciones riesgosas**: Borrar, cancelar, montos altos
- **Respuestas concisas**: MÃ¡ximo 3-4 lÃ­neas
- **Emojis moderados**: Ayudan a escanear, no abusar
- **Contexto temporal**: "MaÃ±ana", "el martes" â†’ resolver a fecha real

### DON'Ts âœ—
- No pedir datos que ya tenemos
- No menÃºs numerados (1. Para X, 2. Para Y)
- No respuestas largas tipo "Claro! EstarÃ© encantado de ayudarte con..."
- No jerga tÃ©cnica en respuestas al usuario
- No asumir sin confirmar en operaciones destructivas

### Ejemplos de Tono
```
âŒ Malo: "Â¡Hola! Â¿En quÃ© puedo ayudarte hoy? Puedo asistirte con..."
âœ“ Bueno: "Hola Pablo ğŸ‘‹"

âŒ Malo: "He registrado exitosamente tu gasto en la categorÃ­a..."
âœ“ Bueno: "âœ“ Registrado: $5,000 en Super (llevas $15k este mes)"

âŒ Malo: "Â¿EstÃ¡s seguro de que deseas eliminar este registro?"
âœ“ Bueno: "Â¿Borro el gasto de $5,000 del super?" (solo si es destructivo)
```

## Modelo de Negocio

### Multi-tenancy
- **Un nÃºmero de WhatsApp** sirve a mÃºltiples tenants (hogares)
- Cada tenant tiene su data completamente aislada
- IdentificaciÃ³n por nÃºmero de telÃ©fono del usuario

### Pricing (futuro)
- **Free tier**: 1 usuario, funciones bÃ¡sicas
- **Premium**: MÃºltiples usuarios, reportes avanzados, integraciones

## Restricciones TÃ©cnicas de Producto

### WhatsApp Business API
- Mensajes tienen lÃ­mite de caracteres (~4096)
- No se puede iniciar conversaciÃ³n (24h rule)
- Templates para mensajes proactivos requieren aprobaciÃ³n de Meta

### Inteligencia Artificial
- El bot puede equivocarse â†’ siempre permitir corregir
- Latencia de LLM â†’ respuestas en <3 segundos idealmente
- Costo por mensaje â†’ optimizar tokens

## Fases del Producto

### ~~Fase 1: POC~~ âœ… COMPLETADA
- ~~OrquestaciÃ³n en n8n~~
- ~~4 funcionalidades core via WhatsApp~~
- ~~Web bÃ¡sica de configuraciÃ³n~~

### Fase 2: MVP (ACTUAL) ğŸ”„
- âœ… MigraciÃ³n a Python (cÃ³digo propio)
- âœ… 5 agentes implementados
- âœ… Panel de administraciÃ³n
- ğŸ”„ Multi-tenant funcional (usando tenant fijo por ahora)
- ğŸ”„ Testing y estabilizaciÃ³n

### Fase 3: ProducciÃ³n
- [ ] Multi-tenant completo con onboarding
- [ ] Recordatorios proactivos
- [ ] Rate limiting y seguridad
- [ ] MÃ©tricas y alertas
- [ ] Backup y recovery

### Fase 4: Growth
- [ ] Integraciones adicionales (bancos, otros calendarios)
- [ ] Funcionalidades premium
- [ ] Mobile app companion
- [ ] Analytics avanzados

## MÃ©tricas de Ã‰xito

### Engagement
- Mensajes por usuario por semana
- RetenciÃ³n a 7/30 dÃ­as
- Funcionalidades mÃ¡s usadas

### Calidad
- % de intenciones correctamente detectadas
- Tiempo de respuesta del bot
- Errores/reintentos por conversaciÃ³n

### Negocio
- Tenants activos
- ConversiÃ³n free â†’ premium
- Churn rate

## Glosario de Dominio

| TÃ©rmino | DefiniciÃ³n |
|---------|------------|
| **Tenant** | Un hogar/cuenta. Agrupa usuarios y toda su data |
| **Owner** | Usuario que creÃ³ el tenant. Permisos totales |
| **Member** | Usuario invitado al tenant. Permisos limitados |
| **Expense** | Gasto registrado con monto, categorÃ­a y fecha |
| **Budget** | Presupuesto mensual definido por categorÃ­a |
| **Event** | Entrada de calendario con fecha/hora |
| **Reminder** | Alerta programada (Ãºnica o recurrente) |
| **Shopping List** | Lista de compras con items |
| **Conversation** | SesiÃ³n de chat con el bot |
| **Interaction** | Un intercambio mensaje-respuesta del bot |
| **Agent** | MÃ³dulo especializado del bot (Finance, Calendar, etc.) |
| **Router** | Agente que decide a quÃ© sub-agente derivar |
